(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-252d194d"],{"0ca0":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("p",{staticClass:"eventType-title"},[e._v(e._s(e.title))]),a("div",{staticClass:"eventType_underLine"},[a("font",{staticStyle:{"font-size":"36px",color:"#F7B500"}},[e._v(e._s(e.val))]),a("span",{staticClass:"eventType-line"},[e._v("/")]),a("font",{style:"font-size:30px;color:"+(0==e.dval?"#999":e.dval>0?"#FF3355":"#1FE2A8")},[e._v(e._s(e.dval>0?"+"+e.dval:e.dval))]),e.dval?a("i",{class:"iconfont "+(e.dval>0?"iconxiangshang":"iconxiangxia"),style:"color: "+(e.dval>0?"#FF3355":"#1FE2A8")}):e._e(),a("span",{staticClass:"eventType-compare"},[e._v("对比昨天")])],1)])},r=[],i=(a("a9e3"),{props:{title:{type:String,default:"事件"},val:{type:Number,default:0},dval:{type:Number,default:0}},data:function(){return{}},methods:{}}),o=i,s=(a("efc6"),a("2877")),l=Object(s["a"])(o,n,r,!1,null,"a6295d7e",null);t["a"]=l.exports},"2c5b":function(e,t,a){},"2c6b":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("ul",[a("li",{class:{active:!e.currentCode},on:{click:function(t){return e.changeType("")}}},[e._v("全部")]),e._l(e.tabList,(function(t,n){return a("li",{key:n+1,class:{active:t.ETID==e.currentCode},on:{click:function(a){return e.changeType(t.ETID)}}},[e._v(" "+e._s(t.etname)+" ")])}))],2),a("div",{staticClass:"content"},[e.currentCode?a("tab-part",{key:e.currentCode,attrs:{typeCode:e.currentCode}}):a("statis-data",{on:{radar:e.changeTab}})],1)])},r=[],i=(a("4160"),a("b0c0"),a("159b"),a("96cf"),a("1da1")),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"statis pb10"},[a("div",{staticClass:"clearfix",staticStyle:{height:"65%"}},[a("div",{staticClass:"fl",staticStyle:{width:"38%",height:"100%"}},[a("radar-echarts",{attrs:{radarData:e.radarData},on:{radar:e.onRadar}})],1),a("div",{staticClass:"fr",staticStyle:{width:"62%",height:"100%"}},[a("div",{staticClass:"pb10 clearfix",staticStyle:{height:"56%"}},[a("border-box",{staticClass:"fl",staticStyle:{width:"50%",height:"100%"}},[a("title-box",{attrs:{title:"事件统计",moreTitle:"更多数据处理",type:"more"},on:{more:e.showMoreEvents}}),a("el-table",{attrs:{data:e.countEvents,height:"calc(100% - 50px)","cell-style":{height:"55px"},"empty-text":"暂无数据"}},[a("el-table-column",{attrs:{prop:"name",label:"统计事件",align:"center","min-width":"2"}}),a("el-table-column",{attrs:{prop:"lv4",label:"超高",align:"center","min-width":"2"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row,r=t.$index;return[a("span",{style:"color:"+(r==e.countEvents.length-1?"#FF9900":"")},[e._v(e._s(n.lv4))])]}}])}),a("el-table-column",{attrs:{prop:"lv3",label:"高",align:"center","min-width":"2"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row,r=t.$index;return[a("span",{style:"color:"+(r==e.countEvents.length-1?"#FF9900":"")},[e._v(e._s(n.lv3))])]}}])}),a("el-table-column",{attrs:{prop:"lv2",label:"中",align:"center","min-width":"2"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row,r=t.$index;return[a("span",{style:"color:"+(r==e.countEvents.length-1?"#FF9900":"")},[e._v(e._s(n.lv2))])]}}])}),a("el-table-column",{attrs:{prop:"lv1",label:"低",align:"center","min-width":"2"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row,r=t.$index;return[a("span",{style:"color:"+(r==e.countEvents.length-1?"#FF9900":"")},[e._v(e._s(n.lv1))])]}}])})],1)],1),a("border-box",{staticClass:"fr pl10",staticStyle:{width:"50%",height:"100%"}},[a("title-box",{attrs:{title:"今日事件",type:"more"}}),a("el-table",{attrs:{data:e.todayEvents,height:"calc(100% - 50px)","empty-text":"暂无数据"}},[a("el-table-column",{attrs:{prop:"name",label:"风险等级",align:"left","min-width":"3"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",{staticClass:"todayEvent-icon",style:"background:"+e.levelColor(n.name)}),a("span",[e._v(e._s(n.name))])]}}])}),a("el-table-column",{attrs:{prop:"hp",label:"发生",align:"center","min-width":"3"}}),a("el-table-column",{attrs:{prop:"bh",label:"闭环",align:"center","min-width":"3"}})],1)],1)],1),a("border-box",{staticStyle:{height:"44%"}},[a("title-box",{attrs:{title:"事件曲线图",moreTitle:"近30日",tabData:e.tabData,type:"tabMore"},on:{change:e.changType}}),a("div",{staticStyle:{height:"calc(100% - 50px)"},attrs:{id:"inspectionEchart"}})],1)],1)]),a("border-box",{staticClass:"pt10",staticStyle:{height:"35%"}},[a("title-box",{attrs:{title:"未处理事件列表",moreTitle:e.unEventTotal+"条未处理数据",tabData:e.levels,type:"tabMore"},on:{change:e.changType1}}),a("el-table",{directives:[{name:"tableLoadMore",rawName:"v-tableLoadMore",value:e.loadMore,expression:"loadMore"}],attrs:{data:e.unEventsData,height:"calc(100% - 50px)","empty-text":"暂无数据"}},[a("el-table-column",{attrs:{prop:"createdate",label:"发生时间",align:"left","min-width":"2"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e._f("creatime")(a.createdate))+" ")]}}])}),a("el-table-column",{attrs:{prop:"sitename",label:"发生项目",align:"left","min-width":"4","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-tooltip",{attrs:{effect:"dark",content:n.sitename,placement:"top-start"}},[a("span",[e._v(e._s(n.sitename))])])]}}])}),a("el-table-column",{attrs:{prop:"groupshortname",label:"所属区域",align:"center","min-width":"2"}}),a("el-table-column",{attrs:{prop:"etname",label:"事件类型",align:"center","min-width":"1"}}),a("el-table-column",{attrs:{prop:"content",label:"事件内容",align:"center","min-width":"4","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.stypename+" "+a.content)+" ")]}}])}),a("el-table-column",{attrs:{prop:"eventlevel",label:"事件等级",align:"center","min-width":"1"}}),a("el-table-column",{attrs:{prop:"eventcode",label:"编号",align:"center","min-width":"3","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",{staticStyle:{cursor:"pointer",color:"#45cbff"},on:{click:function(t){return e.ShoEventDetail(n.EVENTID)}}},[e._v(e._s(n.eventcode))])]}}])}),a("el-table-column",{attrs:{prop:"status",label:"当前状态",align:"center","min-width":"1"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e._f("eventStatus")(a.status))+" ")]}}])}),a("el-table-column",{attrs:{prop:"duration",label:"发生时长",align:"center","min-width":"2"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e._f("formatteDate")(a.createdate))+" ")]}}])})],1)],1),a("el-dialog",{attrs:{title:"发生事件列表",visible:e.isShoEventList,width:"90%"},on:{"update:visible":function(t){e.isShoEventList=t}}},[a("el-form",{attrs:{model:e.eventsParams}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:3,offset:0}},[a("el-input",{attrs:{size:"small",placeholder:"请输入搜索内容"},model:{value:e.eventsParams.keyword,callback:function(t){e.$set(e.eventsParams,"keyword",t)},expression:"eventsParams.keyword"}})],1),a("el-col",{attrs:{span:3,offset:0}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"事件等级",size:"small"},model:{value:e.eventsParams.eventlevel,callback:function(t){e.$set(e.eventsParams,"eventlevel",t)},expression:"eventsParams.eventlevel"}},[a("el-option",{attrs:{label:"全部",value:0}}),a("el-option",{attrs:{label:"超高",value:4}}),a("el-option",{attrs:{label:"高",value:3}}),a("el-option",{attrs:{label:"中",value:2}}),a("el-option",{attrs:{label:"低",value:1}})],1)],1),a("el-col",{attrs:{span:3,offset:0}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"当前状态",size:"small"},model:{value:e.eventsParams.status,callback:function(t){e.$set(e.eventsParams,"status",t)},expression:"eventsParams.status"}},[a("el-option",{attrs:{label:"全部",value:0}}),a("el-option",{attrs:{label:"已处理",value:3}}),a("el-option",{attrs:{label:"未处理",value:1}}),a("el-option",{attrs:{label:"处理中",value:2}})],1)],1),a("el-col",{attrs:{span:3,offset:0}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.getEventsData}},[e._v("搜索")])],1)],1)],1),a("el-table",{staticClass:"mt10",attrs:{data:e.eventsData}},[a("el-table-column",{attrs:{prop:"createdate",label:"发生时间",align:"left","min-width":"3"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e._f("creatime")(a.createdate))+" ")]}}])}),a("el-table-column",{attrs:{prop:"sitename",label:"发生项目",align:"left","min-width":"4","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-tooltip",{attrs:{effect:"dark",content:n.sitename,placement:"top-start"}},[a("span",[e._v(e._s(n.sitename))])])]}}])}),a("el-table-column",{attrs:{prop:"groupshortname",label:"所属区域",align:"center","min-width":"2"}}),a("el-table-column",{attrs:{prop:"etname",label:"事件类型",align:"center","min-width":"2"}}),a("el-table-column",{attrs:{prop:"content",label:"事件内容",align:"center","min-width":"4","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.stypename+" "+a.content)+" ")]}}])}),a("el-table-column",{attrs:{prop:"eventlevel",label:"事件等级",align:"center","min-width":"2"}}),a("el-table-column",{attrs:{prop:"eventcode",label:"编号",align:"center","min-width":"4","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",{staticStyle:{cursor:"pointer",color:"#45cbff"},on:{click:function(t){return e.ShoEventDetail(n.EVENTID)}}},[e._v(e._s(n.eventcode))])]}}])}),a("el-table-column",{attrs:{prop:"status",label:"当前状态",align:"center",sortable:"","min-width":"2"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e._f("eventStatus")(a.status))+" ")]}}])}),a("el-table-column",{attrs:{prop:"handler",label:"现场参与人员",align:"center","min-width":"2"}}),a("el-table-column",{attrs:{prop:"duration",label:"发生时长",align:"center","min-width":"2"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e._f("formatteDate")(a.createdate))+" ")]}}])})],1),a("el-pagination",{staticClass:"mt20 fr",attrs:{layout:"prev, pager, next","page-size":e.eventsParams.size,"current-page":e.eventsParams.page,total:e.eventsTotal},on:{"current-change":e.hourListPageChange}})],1),a("el-dialog",{attrs:{title:"事件详情",visible:e.isShoEventDetail,width:"45%"},on:{"update:visible":function(t){e.isShoEventDetail=t}}},[a("event-detail",{attrs:{detailId:e.detailId}})],1)],1)},s=[],l=(a("99af"),a("d81d"),a("a9e3"),a("ac1f"),a("1276"),a("2af9")),c=a("365c"),_=a("2f62"),u=a("ac0d"),d=a("edfc"),p=a("313e"),v={components:{TitleBox:l["g"],BorderBox:l["a"],RadarEcharts:l["f"],eventDetail:d["a"]},mixins:[u["a"],u["b"],u["c"]],data:function(){return{tabData:["发生事件","闭环事件"],isShoEventList:!1,isShoEventDetail:!1,unEventsData:[],eventsData:[],radarData:[],unEventParams:{eventlevel:4,status:1,page:1,size:10},eventsParams:{keyword:"",eventlevel:0,status:0,page:1,size:10},unEventTotal:0,eventsTotal:0,countEvents:[],todayEvents:[],detailId:""}},computed:Object(_["c"])(["CITY"]),watch:{CITY:{immediate:!0,deep:!0,handler:function(e,t){this.unEventsData=[],this.unEventParams.page=1,this.getEventsRadar(),this.getEventsCurve(),this.getEventsCount(),this.getUnEventsData()}}},created:function(){},methods:{getUnEventsData:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,c["a"].untreatedevent(e.unEventParams);case 2:a=t.sent,n=a.success,r=a.data,n&&(e.unEventsData=e.unEventsData.concat(r.data),e.unEventTotal=r.dataCount);case 6:case"end":return t.stop()}}),t)})))()},getEventsData:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,c["a"].untreatedevent(e.eventsParams);case 2:a=t.sent,n=a.success,r=a.data,n&&(r.data.map((function(e){e.status=Number(e.status)})),e.eventsData=r.data,e.eventsTotal=r.dataCount);case 6:case"end":return t.stop()}}),t)})))()},showMoreEvents:function(){this.isShoEventList=!0,this.eventsParams.page=1,this.getEventsData()},loadMore:function(){this.unEventsData.length<this.unEventTotal&&(this.unEventParams.page++,this.getUnEventsData())},changType:function(e){this.getEventsCurve(e+1)},changType1:function(e){this.unEventsData=[],this.unEventParams.page=1,this.unEventParams.eventlevel=this.levels[e].lv,this.getUnEventsData()},ShoEventDetail:function(e){this.isShoEventDetail=!0,this.detailId=e},getEventsCurve:function(){var e=arguments,t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n,r,i,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:1,a.next=3,c["a"].eventcurve({eventStatus:n,days:30});case 3:r=a.sent,i=r.success,o=r.data,i&&o&&t.initEchart(o);case 7:case"end":return a.stop()}}),a)})))()},getEventsRadar:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,c["a"].eventsRadar();case 2:a=t.sent,n=a.success,r=a.data,n&&r&&(e.radarData=r);case 6:case"end":return t.stop()}}),t)})))()},getEventsCount:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,n,r,i,o,s,l,_,u,d,p,v,h,f,m,b,g,E,y,w,D,C;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,c["a"].eventCounts();case 2:a=t.sent,n=a.success,r=a.data,n&&(i=JSON.parse(r.Statistic)||[],o=JSON.parse(r.Today)||[],s={name:"累计发生"},l={name:"未处理"},_={name:"闭环率"},u=[],i.forEach((function(e,t){var a=e["total"+(t+1)],n=e["untreated"+(t+1)];s["lv"+(t+1)]=a,l["lv"+(t+1)]=n;var r=parseInt((a-n)/a*100);_["lv"+(t+1)]=r?r+"%":0})),u.push(s,l,_),e.countEvents=u,d=[],p=0,v=0,h=0,f=0,m=0,b=0,g=0,E=0,y={name:"超高"},w={name:"高"},D={name:"中"},C={name:"低"},o.forEach((function(e){4==e.eventlevel&&(p=e.count+p,3!=e.status&&4!=e.status||(m=e.count+m)),3==e.eventlevel&&(v=e.count+v,3!=e.status&&4!=e.status||(b=e.count+b)),2==e.eventlevel&&(h=e.count+h,3!=e.status&&4!=e.status||(g=e.count+g)),1==e.eventlevel&&(f=e.count+f,3!=e.status&&4!=e.status||(E=e.count+E))})),y["hp"]=p,w["hp"]=v,D["hp"]=h,C["hp"]=f,y["bh"]=m,w["bh"]=b,D["bh"]=g,C["bh"]=E,d.push(y,w,D,C),e.todayEvents=d);case 6:case"end":return t.stop()}}),t)})))()},initEchart:function(e){var t=p.init(document.getElementById("inspectionEchart"));window.addEventListener("resize",(function(){t.resize()}));var a={tooltip:{show:!0,trigger:"axis"},color:["#00ffda","#8C45FF","#f7b500","#ff3355"],legend:{icon:"roundRect",data:["超高","高","中","低"],textStyle:{color:"#fff"},itemGap:50,itemWidth:20,itemHeight:12},grid:{containLabel:!0,left:"20",right:"20",top:"30",bottom:"20"},xAxis:{type:"category",data:e[0].data.map((function(e){return e.date})),axisLine:{show:!0,lineStyle:{color:"#1f5098"}},boundaryGap:!1,axisLabel:{color:"#ffffff",formatter:function(e){return parseInt(e.split("-")[2])}},axisTick:{inside:!1,alignWithLabel:!0,lineStyle:{color:"#ffffff"}},splitLine:{show:!0,lineStyle:{color:"#1f5098"}}},yAxis:{type:"value",axisLine:{show:!0,lineStyle:{color:"#1f5098"}},axisTick:{inside:!1,alignWithLabel:!1,length:10,lineStyle:{color:"#ffffff"}},axisLabel:{color:"#ffffff"},splitLine:{show:!0,lineStyle:{color:"#1f5098"}},splitNumber:4},series:e.map((function(e){return{name:1==e.level?"低":2==e.level?"中":3==e.level?"高":"超高",type:"line",data:e.data.map((function(e){return e.count})),smooth:!0,symbol:"none"}}))};t.setOption(a)},hourListPageChange:function(e){this.eventsParams.page=e,this.getEventsData()},onRadar:function(e){this.$emit("radar",e)}}},h=v,f=(a("94ed"),a("2877")),m=Object(f["a"])(h,o,s,!1,null,"e22210b4",null),b=m.exports,g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tabPart pb10 clearfix"},[a("border-box",{staticClass:"fl pr10",staticStyle:{width:"30%",height:"100%"}},[a("div",{staticStyle:{height:"30%","padding-bottom":"10px"}},[a("title-box",{attrs:{title:"今日风险统计",type:"more"}}),a("div",{staticStyle:{height:"calc(100% - 50px)"}},[a("el-row",{attrs:{gutter:20}},e._l(e.leftTopData,(function(t,n){return a("el-col",{key:n,style:"margin-top:"+(0==n||1==n?"10px":"20px"),attrs:{span:10,offset:1}},[a("eventCount",{attrs:{title:e.eventLevel(t.level)+"风险事件",val:t.today,dval:t.today-t.yesterday}})],1)})),1)],1)],1),a("el-table",{attrs:{data:e.leftMidData,height:0==e.CITY.RegionId?"calc(32%)":"calc(12%)","empty-text":"暂无数据"}},[a("el-table-column",{attrs:{prop:"groupshortname",label:"区级名称",align:"left","min-width":"4","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",{staticClass:"deviceArea-icon",style:"background:"+e.levelColor(n.current)}),a("span",{staticStyle:{display:"inline-block","vertical-align":"middle"}},[e._v("【"+e._s(n.groupshortname)+"】")])]}}])}),a("el-table-column",{attrs:{prop:"lv4",label:"超高",align:"center","min-width":"2"}}),a("el-table-column",{attrs:{prop:"lv3",label:"高",align:"center","min-width":"2"}}),a("el-table-column",{attrs:{prop:"lv2",label:"中",align:"center","min-width":"2"}}),a("el-table-column",{attrs:{prop:"lv1",label:"低",align:"center","min-width":"2"}}),a("el-table-column",{attrs:{prop:"current",label:"当前风险",align:"center","min-width":"3"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(e.eventLevel(n.current)))])]}}])})],1),0==e.CITY.RegionId?a("div",{staticClass:"eventType-roundCount",staticStyle:{height:"36%","padding-top":"10px"}},[a("ul",{staticClass:"ml10"},e._l(e.levels,(function(t,n){return a("li",{key:n,class:t.lv==e.currentLevel?"active":"",on:{click:function(a){return e.changLevel(t.lv)}}},[e._v(" "+e._s(t.name)+" ")])})),0),a("div",{staticClass:"pie-echarts",staticStyle:{height:"calc(100% - 50px)"},attrs:{id:"pie-echarts1"}})]):[a("div",{staticStyle:{height:"26%"}},[a("title-box",{attrs:{title:"近30天风险趋势",type:"more"}}),a("trend-echart",{staticStyle:{height:"calc(100% - 50px)"},attrs:{echartData:e.echartData,isFilter:!1}})],1),a("div",{staticStyle:{height:"32%"}},[a("title-box",{attrs:{title:"近30天风险趋势",type:"more"}}),a("div",{staticClass:"pie-echarts",staticStyle:{height:"calc(100% - 50px)"},attrs:{id:"pie-echarts2"}})],1)]],2),a("div",{staticClass:"fr",staticStyle:{width:"70%",height:"100%"}},[a("div",{staticClass:"clearfix",style:"CG"==e.typeCode?"height: 66%":"height: 30%"},[a("border-box",{staticClass:"fl",staticStyle:{width:"50%",height:"100%"}},[a("title-box",{attrs:{title:"项目风险排行Top10",type:"more",moreTitle:"更多"},on:{more:function(t){e.dialogVisible1=!0}}}),a("el-table",{attrs:{data:e.centerTopData,height:"calc(100% - 50px)","empty-text":"暂无数据"}},[a("el-table-column",{attrs:{prop:"sitename",label:"项目名称",align:"left","min-width":"5","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-tooltip",{attrs:{effect:"dark",content:n.sitename,placement:"top-start"}},[a("span",[e._v(e._s(n.sitename&&"null"!=n.sitename?n.sitename:"-"))])])]}}])}),a("el-table-column",{attrs:{prop:"groupshortname",label:"所属区域",align:"center","min-width":"2"}}),a("el-table-column",{attrs:{prop:"level",label:"当前风险",align:"center","min-width":"2"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",{style:"color:"+e.levelColor(n.level)},[e._v(e._s(e._f("eventLevel")(n.level))+"风险")])]}}])})],1)],1),a("border-box",{staticClass:"fr pl10",staticStyle:{width:"50%",height:"100%"}},[a("title-box",{attrs:{title:"企业风险排行Top10",type:"more",moreTitle:"更多"},on:{more:function(t){e.dialogVisible2=!0}}}),a("el-table",{attrs:{data:e.centerRightData,height:"calc(100% - 50px)","empty-text":"暂无数据"}},[a("el-table-column",{attrs:{prop:"builder",label:"企业名称",align:"left","min-width":"5","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.builder&&"null"!=a.builder?a.builder:"-")+" ")]}}])}),a("el-table-column",{attrs:{prop:"projcount",label:"项目数",align:"center","min-width":"2"}}),a("el-table-column",{attrs:{prop:"level",label:"当前风险",align:"center","min-width":"2"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",{style:"color:"+e.levelColor(n.level)},[e._v(e._s(e._f("eventLevel")(n.level))+"风险")])]}}])})],1)],1)],1),"CG"!=e.typeCode?a("border-box",{staticClass:"pt10",staticStyle:{height:"36%"}},[a("title-box",{attrs:{title:"触发事件内容统计",tabData:e.daysTabs,type:"tab"},on:{change:e.changDays}}),a("div",{staticClass:"eventTrigger"},[a("ul",e._l(e.levels,(function(t,n){return a("li",{key:n,class:t.lv==e.currentTrigger?"active":"",on:{click:function(a){return e.changTrigger(t.lv)}}},[e._v(" "+e._s(t.name)+" ")])})),0)]),a("div",{staticClass:"pt10 clearfix",staticStyle:{height:"calc(100% - 50px)"}},[a("div",{staticClass:"pie-echarts fl",staticStyle:{width:"50%",height:"100%"},attrs:{id:"pie-echarts3"}}),a("el-table",{staticClass:"fr",staticStyle:{width:"50%"},attrs:{data:e.centerMidData,height:"100%","empty-text":"暂无数据"}},[a("el-table-column",{attrs:{prop:"name",label:"事件内容",align:"left","min-width":"5","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"value",label:"发生次数",align:"center","min-width":"2"}}),a("el-table-column",{attrs:{prop:"percent",label:"占比",align:"center","min-width":"2"}}),a("el-table-column",{attrs:{prop:"percent1",label:"对比",align:"center","min-width":"2"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.percent1?n.percent1:"-"))]),n.isUp?[a("i",{class:"iconfont "+(n.isUp>0?"iconxiangshang":"iconxiangxia"),style:"color: "+(n.isUp>0?"#FF3355":"#1FE2A8")})]:e._e()]}}],null,!1,3066732169)})],1)],1)],1):e._e(),a("border-box",{staticClass:"pt10",staticStyle:{height:"34%"}},[a("title-box",{ref:"countTab",attrs:{title:"事件风险统计",tabData:e.tabData1,type:"tab"},on:{change:e.changType2}}),a("div",{staticStyle:{height:"calc(100% - 50px)"},attrs:{id:"typeCountEchart"}})],1)],1),a("el-dialog",{attrs:{title:"项目列表",visible:e.dialogVisible1,width:"70%"},on:{"update:visible":function(t){e.dialogVisible1=t}}},[a("project-list",{attrs:{projectCount:e.projectCount}})],1),a("el-dialog",{attrs:{title:"企业列表",visible:e.dialogVisible2,width:"70%"},on:{"update:visible":function(t){e.dialogVisible2=t}}},[a("company-list",{attrs:{companyCount:e.companyCount}})],1)],1)},E=[],y=a("f283"),w=y["a"],D=(a("4970"),Object(f["a"])(w,g,E,!1,null,"3a4a7e92",null)),C=D.exports,x=a("4360"),P={components:{statisData:b,tabPart:C},data:function(){return{currentCode:x["a"].state.currentCode,tabList:[]}},created:function(){this.getParentEventType()},methods:{changeType:function(e){this.currentCode=e,x["a"].commit("SET_CODE",e)},changeTab:function(e){var t=this;this.tabList.forEach((function(a){a.etname==e.name&&t.changeType(a.ETID)}))},getParentEventType:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,c["a"].parentEventType();case 2:a=t.sent,n=a.success,r=a.data,n&&r&&(e.tabList=r);case 6:case"end":return t.stop()}}),t)})))()}}},T=P,O=(a("bab6"),a("b517"),a("af6f"),Object(f["a"])(T,n,r,!1,null,"7f5b52fa",null));t["default"]=O.exports},"380c":function(e,t,a){},"3a37":function(e,t,a){},4970:function(e,t,a){"use strict";var n=a("c70a"),r=a.n(n);r.a},"675e":function(e,t,a){},"94ed":function(e,t,a){"use strict";var n=a("3a37"),r=a.n(n);r.a},"99af":function(e,t,a){"use strict";var n=a("23e7"),r=a("d039"),i=a("e8b5"),o=a("861d"),s=a("7b0b"),l=a("50c4"),c=a("8418"),_=a("65f0"),u=a("1dde"),d=a("b622"),p=a("2d00"),v=d("isConcatSpreadable"),h=9007199254740991,f="Maximum allowed index exceeded",m=p>=51||!r((function(){var e=[];return e[v]=!1,e.concat()[0]!==e})),b=u("concat"),g=function(e){if(!o(e))return!1;var t=e[v];return void 0!==t?!!t:i(e)},E=!m||!b;n({target:"Array",proto:!0,forced:E},{concat:function(e){var t,a,n,r,i,o=s(this),u=_(o,0),d=0;for(t=-1,n=arguments.length;t<n;t++)if(i=-1===t?o:arguments[t],g(i)){if(r=l(i.length),d+r>h)throw TypeError(f);for(a=0;a<r;a++,d++)a in i&&c(u,d,i[a])}else{if(d>=h)throw TypeError(f);c(u,d++,i)}return u.length=d,u}})},a15b:function(e,t,a){"use strict";var n=a("23e7"),r=a("44ad"),i=a("fc6a"),o=a("a640"),s=[].join,l=r!=Object,c=o("join",",");n({target:"Array",proto:!0,forced:l||!c},{join:function(e){return s.call(i(this),void 0===e?",":e)}})},af6f:function(e,t,a){"use strict";var n=a("c067"),r=a.n(n);r.a},b517:function(e,t,a){"use strict";var n=a("2c5b"),r=a.n(n);r.a},bab6:function(e,t,a){"use strict";var n=a("675e"),r=a.n(n);r.a},c067:function(e,t,a){},c70a:function(e,t,a){},efc6:function(e,t,a){"use strict";var n=a("380c"),r=a.n(n);r.a},f283:function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("4160"),core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es_array_join__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("a15b"),core_js_modules_es_array_join__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_array_join__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("d81d"),core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("b0c0"),core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("ac1f"),core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("1276"),core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("159b"),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_6__),regenerator_runtime_runtime__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("96cf"),regenerator_runtime_runtime__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(regenerator_runtime_runtime__WEBPACK_IMPORTED_MODULE_7__),D_analyse_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("1da1"),_components__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("2af9"),_views_dashboard_components_trendEchart_vue__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("8b0f"),_eventCount__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("0ca0"),_api__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("365c"),vuex__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("2f62"),_utils_mixin_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("ac0d"),echarts=__webpack_require__("313e");__webpack_exports__["a"]={components:{TitleBox:_components__WEBPACK_IMPORTED_MODULE_9__["g"],BorderBox:_components__WEBPACK_IMPORTED_MODULE_9__["a"],eventCount:_eventCount__WEBPACK_IMPORTED_MODULE_11__["a"],CompanyList:_components__WEBPACK_IMPORTED_MODULE_9__["b"],ProjectList:_components__WEBPACK_IMPORTED_MODULE_9__["e"],trendEchart:_views_dashboard_components_trendEchart_vue__WEBPACK_IMPORTED_MODULE_10__["a"]},props:{typeCode:{type:String}},mixins:[_utils_mixin_js__WEBPACK_IMPORTED_MODULE_14__["a"],_utils_mixin_js__WEBPACK_IMPORTED_MODULE_14__["b"],_utils_mixin_js__WEBPACK_IMPORTED_MODULE_14__["c"]],data:function(){return{currentLevel:4,currentDays:1,tabIndex2:0,currentTrigger:4,tabData1:["月统计","年统计"],dialogVisible1:!1,dialogVisible2:!1,leftTopData:[],leftMidData:[],centerTopData:[],centerRightData:[],centerMidData:[],echartData:[],xData:[],yData:[],projectCount:{},companyCount:{}}},computed:Object(vuex__WEBPACK_IMPORTED_MODULE_13__["c"])(["CITY"]),watch:{CITY:{immediate:!0,deep:!0,handler:function(e,t){var a=this;this.getTypeLevels(),this.getEventsAreaCounts(0),this.getProjectRiskRank(),this.getEnterPriseRiskRank(),this.getEventContentStatistic(),0==e.RegionId&&(this.currentLevel=4,this.getEventsAreaCounts(4)),this.$nextTick((function(e){a.$refs.countTab.chooseDaliy(0)}))}}},mounted:function(){},created:function(){},methods:{getTypeLevels:function getTypeLevels(){var _this2=this;return Object(D_analyse_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_8__["a"])(regeneratorRuntime.mark((function _callee(){var _yield$fetch$eventcur,success,data,counts,pieData,colors;return regeneratorRuntime.wrap((function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:return _context.next=2,_api__WEBPACK_IMPORTED_MODULE_12__["a"].eventcurve({eventStatus:1,days:30,typecode:_this2.typeCode});case 2:_yield$fetch$eventcur=_context.sent,success=_yield$fetch$eventcur.success,data=_yield$fetch$eventcur.data,success&&data&&(counts=[],pieData=[],_this2.yData=[],data.forEach((function(item){_this2.xData=item.data.map((function(e){return e.date})),_this2.yData.push(item.data.map((function(e){return e.count}))),counts.push({today:item.data[item.data.length-1].count,yesterday:item.data[item.data.length-2].count,level:item.level}),pieData.push({name:_this2.eventLevel(item.level),value:eval(item.data.map((function(e){return e.count})).join("+"))}),_this2.echartData=item.data.map((function(e){return{name:e.date,value:e.currentLv}}))})),_this2.leftTopData=counts.reverse(),_this2.initEchart(_this2.xData,_this2.yData),0!=_this2.CITY.RegionId&&(colors=["#1FE2A8","#8C45FF","#FF9900","#FF3355"],_this2.initPie(pieData,colors,"pie-echarts2",!0)));case 6:case"end":return _context.stop()}}),_callee)})))()},getEventcurveyear:function(){var e=this;return Object(D_analyse_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_8__["a"])(regeneratorRuntime.mark((function t(){var a,n,r,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,_api__WEBPACK_IMPORTED_MODULE_12__["a"].eventcurveyear({typecode:e.typeCode});case 2:a=t.sent,n=a.success,r=a.data,n&&r&&(i=r.map((function(e){return e.CreationDate})),o=[r.map((function(e){return e.lv1})),r.map((function(e){return e.lv2})),r.map((function(e){return e.lv3})),r.map((function(e){return e.lv4}))],e.initEchart(i,o));case 6:case"end":return t.stop()}}),t)})))()},getEventsAreaCounts:function(){var e=arguments,t=this;return Object(D_analyse_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_8__["a"])(regeneratorRuntime.mark((function a(){var n,r,i,o,s,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:0,a.next=3,_api__WEBPACK_IMPORTED_MODULE_12__["a"].eventsAreaCounts({typecode:t.typeCode,eventlevel:n});case 3:r=a.sent,i=r.success,o=r.data,i&&o&&(0==n?t.leftMidData=o:(s=["#F7B500","#D19C18","#AC832F","#866B47","#45CBFF","#43AEE4","#4190C8","#3F73AB"],l=o.map((function(e){return{name:e.groupshortname,value:e["lv"+n]}})),t.initPie(l,s,"pie-echarts1")));case 7:case"end":return a.stop()}}),a)})))()},getProjectRiskRank:function(){var e=arguments,t=this;return Object(D_analyse_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_8__["a"])(regeneratorRuntime.mark((function a(){var n,r,i,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:1,a.next=3,_api__WEBPACK_IMPORTED_MODULE_12__["a"].projectRiskRank({typecode:t.typeCode,page:n,size:10});case 3:r=a.sent,i=r.success,o=r.data,i&&o.data&&(o.data.forEach((function(e){e.level=e.lv4?4:e.lv3?3:e.lv2?2:1})),t.centerTopData=o.data);case 7:case"end":return a.stop()}}),a)})))()},getEnterPriseRiskRank:function(){var e=arguments,t=this;return Object(D_analyse_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_8__["a"])(regeneratorRuntime.mark((function a(){var n,r,i,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:1,a.next=3,_api__WEBPACK_IMPORTED_MODULE_12__["a"].enterPriseRiskRank({typecode:t.typeCode,page:n,size:10});case 3:r=a.sent,i=r.success,o=r.data,i&&o.data&&(o.data.forEach((function(e){e.level=e.lv4?4:e.lv3?3:e.lv2?2:1})),t.centerRightData=o.data);case 7:case"end":return a.stop()}}),a)})))()},getEventContentStatistic:function getEventContentStatistic(){var _arguments4=arguments,_this7=this;return Object(D_analyse_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_8__["a"])(regeneratorRuntime.mark((function _callee6(){var eventlevel,_yield$fetch$eventCon,success,data,total;return regeneratorRuntime.wrap((function _callee6$(_context6){while(1)switch(_context6.prev=_context6.next){case 0:return eventlevel=_arguments4.length>0&&void 0!==_arguments4[0]?_arguments4[0]:0,_context6.next=3,_api__WEBPACK_IMPORTED_MODULE_12__["a"].eventContentStatistic({typecode:_this7.typeCode,eventlevel:eventlevel,days:_this7.currentDays});case 3:_yield$fetch$eventCon=_context6.sent,success=_yield$fetch$eventCon.success,data=_yield$fetch$eventCon.data,success&&data&&(total=eval(data.map((function(e){return e.nowcount})).join("+")),data=data.map((function(e){return{name:e.etname,value:e.nowcount,percent:e.nowcount<=0?0:Math.round(e.nowcount/total*1e4)/100+"%",percent1:e.nowcount<=0&&e.beforecount<=0?0:e.nowcount<=0||e.beforecount<=0?"100%":e.nowcount-e.beforecount>0?Math.round((e.nowcount-e.beforecount)/e.beforecount*1e4)/100+"%":Math.round((e.beforecount-e.nowcount)/e.beforecount*1e4)/100+"%",isUp:e.nowcount-e.beforecount==0?0:e.nowcount-e.beforecount>0?1:-1}})),_this7.centerMidData=data,0==eventlevel&&_this7.initPie1(data));case 7:case"end":return _context6.stop()}}),_callee6)})))()},changLevel:function(e){this.currentLevel=e,this.getEventsAreaCounts(e)},changTrigger:function(e){this.currentTrigger=e,this.getEventContentStatistic(e)},changDays:function(e){this.currentDays=this.daysTabs[e].days,this.getEventContentStatistic()},changType2:function(e){this.tabIndex2=e,0==e?this.initEchart(this.xData,this.yData):this.getEventcurveyear()},initPie:function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=document.getElementById(a);if(r){var i=echarts.init(r),o={color:t,tooltip:{show:!1},legend:{show:n,bottom:0,itemGap:40,itemWidth:20,itemHeight:12,textStyle:{color:"#fff"}},series:[{radius:["40%","60%"],bottom:n?20:0,type:"pie",label:{alignTo:"labelLine",formatter:["{name|{b}  {c}}","{value|{d}%}"].join("\n"),minMargin:5,lineHeight:15,fontSize:13,labelLine:{length1:30},rich:{name:{color:"#45CBFF"},value:{color:"#ffffff"}}},rich:{name:{color:"#45CBFF"},value:{color:"#ffffff"}},data:e}]};i.setOption(o),window.addEventListener("resize",(function(){i.resize()}))}},initPie1:function(e){var t=document.getElementById("pie-echarts3");if(t){var a=echarts.init(t);window.addEventListener("resize",(function(){a.resize()})),a.setOption({color:["#3642AB","rgba(33, 130, 255, 0.45)","#2182FF","rgba(33, 130, 255, 0.66)","rgba(33, 130, 255, 0.24)","rgba(33, 130, 255, 0.1)","#3D68B5","rgba(61, 104, 181, 0.56)","#4947C8","#3735A1","#2E2C8D"],tooltip:{show:!0,backgroundColor:"rgba(0, 0, 0, 0.75)",borderWidth:0,textStyle:{color:"#fff"},formatter:function(e){return"事件内容<div style='height:10px'></div><span style='font-size:12px'>"+e.name+"<br/>"+e.value+"<span style='color:#F7B500;margin-left:20px'>"+e.percent+"%</span></span>"}},series:{type:"pie",radius:[0,"70%"],label:{alignTo:"labelLine",formatter:"{b}",minMargin:5,edgeDistance:10,lineHeight:15,fontSize:12,color:"#fff",fontWeight:"lighter",labelLine:{length1:30}},data:e}})}},initEchart:function(e,t){var a=echarts.init(document.getElementById("typeCountEchart")),n={legend:{data:["超高","高","中","低"],textStyle:{color:"#fff"},itemGap:30,itemWidth:20,itemHeight:12},tooltip:{trigger:"axis",confine:!0},grid:{left:"5%",right:"30",top:"30",bottom:"25"},xAxis:{type:"category",data:e,axisLine:{show:!0,lineStyle:{color:"#ffffff"}},axisLabel:{formatter:function(t){return e&&e.length>12?t&&t.split("-")[2]:t}},show:!0,axisTick:{alignWithLabel:!0,length:5,lineStyle:{color:"#ffffff"}},splitLine:{show:!0,lineStyle:{color:"#1f5098"}}},yAxis:{type:"value",axisLine:{show:!0,lineStyle:{color:"#ffffff"}},axisTick:{inside:!1,lineStyle:{color:"#f00",type:"dashed"}},splitLine:{show:!0,lineStyle:{color:"#1f5098"}}},series:[{name:"超高",data:t[3],stack:"风险等级",type:"bar",label:{show:!1},barWidth:e&&e.length>12?20:40,itemStyle:{color:"#FF3355"},showBackground:!0,backgroundStyle:{color:"rgba(180, 180, 180, 0)"}},{name:"高",data:t[2],stack:"风险等级",type:"bar",label:{show:!1},barWidth:e&&e.length>12?20:40,itemStyle:{color:"#F7B500"},showBackground:!0,backgroundStyle:{color:"rgba(180, 180, 180, 0)"}},{name:"中",data:t[1],stack:"风险等级",type:"bar",label:{show:!1},barWidth:e&&e.length>12?20:40,itemStyle:{color:"#8C45FF"},showBackground:!0,backgroundStyle:{color:"rgba(180, 180, 180, 0)"}},{name:"低",data:t[0],stack:"风险等级",type:"bar",label:{show:!1},barWidth:e&&e.length>12?20:40,itemStyle:{color:"#1FE2A8"},showBackground:!0,backgroundStyle:{color:"rgba(180, 180, 180, 0)"}}]};a.setOption(n),window.addEventListener("resize",(function(){a.resize()}))}}}}}]);