webpackJsonp([44],{ZTOI:function(e,t){},yC5w:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=s("fZjL"),n=s.n(l),a=s("P9l9"),c={components:{},data:function(){return{selectRole:0,loadingSave:!1,roles:[],rolerights:[],checkedMenuids:[],defaultProps:{children:"children",label:"label"}}},mounted:function(){this.getRoles()},methods:{getRoles:function(){var e=this;Object(a._96)().then(function(t){if(t.success){var s=t.data.filter(function(e){return e.ROLEID>1});e.roles=s,s.length>0&&(0==e.selectRole&&(e.selectRole=s[0].ROLEID),e.getRoleRights())}})},getRoleRights:function(){var e=this,t={ROLEID:this.selectRole};Object(a._127)(t).then(function(t){if(t.success){var s=[],l={},a={};e.checkedMenuids=[],t.data.forEach(function(t){"000"==t.MENUID.slice(-3)?(n()(a).length>0&&l.children.push(a),a={},n()(l).length>0&&s.push([l]),l={id:t.MENUID,label:t.name,children:[]}):"00"==t.sort.slice(-2)?(n()(a).length>0&&l.children.push(a),a={id:t.MENUID,label:t.name,children:[]},"1"==t.brole&&e.checkedMenuids.push(t.MENUID)):(a.children.push({id:t.MENUID,label:t.name}),"1"==t.brole&&e.checkedMenuids.push(t.MENUID))}),n()(a).length>0&&l.children.push(a),n()(l).length>0&&s.push([l]),e.rolerights=s}})},handleSave:function(){var e=this;this.loadingSave=!0;var t=[];this.$refs.roleRightTree.forEach(function(e){var s=e.getCheckedKeys(!0);t=t.concat(s)});var s={ROLEID:this.selectRole,MENUIDS:t.join(",")};Object(a._235)(s).then(function(t){t.success?(e.$message({message:"保存成功",type:"success"}),e.getRoles()):e.$message({message:t.msg,type:"error"}),e.loadingSave=!1})},changeRole:function(e){this.selectRole=e,this.getRoleRights()}}},i={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-row",[s("el-col",{attrs:{span:4}},[s("el-card",{staticClass:"box-card left-aside"},[s("div",{attrs:{slot:"header"},slot:"header"},[s("span",[e._v("角色")])]),e._v(" "),s("div",{staticStyle:{height:"70vh"}},[s("el-scrollbar",{staticStyle:{height:"100%"}},e._l(e.roles,function(t,l){return s("div",{key:t.ROLEID,ref:"role"+t.ROLEID,refInFor:!0,staticClass:"left-item",class:t.ROLEID==e.selectRole?"active":"",on:{click:function(s){return e.changeRole(t.ROLEID)}}},[s("div",[s("i",{staticClass:"el-icon-price-tag"}),e._v("\n                            "+e._s(t.rolename)+"\n                        ")])])}),0)],1)])],1),e._v(" "),s("el-col",{staticStyle:{padding:"0 20px"},attrs:{span:20}},[s("el-card",{staticClass:"box-card"},[s("div",{attrs:{slot:"header"},slot:"header"},[s("span",[e._v("菜单")]),e._v(" "),s("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{loading:e.loadingSave,type:"text"},on:{click:e.handleSave}},[e._v("保存")])],1),e._v(" "),s("div",{staticClass:"block"},[s("el-row",{staticClass:"tree-parent",attrs:{type:"flex",justify:"center"}},e._l(e.rolerights,function(t){return s("el-col",{key:t.MENUID},[s("el-tree",{ref:"roleRightTree",refInFor:!0,attrs:{data:t,"show-checkbox":"","default-expand-all":"","node-key":"id","default-checked-keys":e.checkedMenuids,props:e.defaultProps}})],1)}),1)],1)])],1)],1)},staticRenderFns:[]};var r=s("VU/8")(c,i,!1,function(e){s("ZTOI")},"data-v-37b2b0ba",null);t.default=r.exports}});
//# sourceMappingURL=44.df02c08d53ab6b1600b4.js.map