{"version":3,"sources":["webpack:///src/views/roleright/index.vue","webpack:///./src/views/roleright/index.vue?cbdb","webpack:///./src/views/roleright/index.vue"],"names":["roleright","components","data","selectRole","loadingSave","roles","rolerights","checkedMenuids","defaultProps","children","label","mounted","this","getRoles","methods","_this","Object","api","then","res","success","filter","item","ROLEID","length","getRoleRights","_this2","param","rolerightall","item1","item2","forEach","MENUID","slice","keys_default","push","id","name","sort","brole","handleSave","_this3","MENUIDS","$refs","roleRightTree","t","tempids","getCheckedKeys","concat","para","join","$message","message","type","msg","changeRole","val","views_roleright","render","_vm","_h","$createElement","_c","_self","attrs","span","staticClass","slot","_v","staticStyle","height","_l","index","key","ref","refInFor","class","on","click","$event","_s","rolename","padding","float","loading","justify","show-checkbox","default-expand-all","node-key","default-checked-keys","props","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"../static/js/44.85249100e4434cc2a8e9.js","sourcesContent":["<template>\r\n    <el-row>\r\n        <el-col :span=\"4\">\r\n            <el-card class=\"box-card left-aside\">\r\n                <div slot=\"header\" class=\"\">\r\n                    <span>角色</span>\r\n                </div>\r\n                <div style=\"height: 70vh\">\r\n                    <el-scrollbar style=\"height: 100%\">\r\n                        <div\r\n                            v-for=\"(item, index) in roles\"\r\n                            :key=\"item.ROLEID\"\r\n                            :ref=\"`role${item.ROLEID}`\"\r\n                            :class=\"item.ROLEID == selectRole ? 'active' : ''\"\r\n                            class=\"left-item\"\r\n                            @click=\"changeRole(item.ROLEID)\"\r\n                        >\r\n                            <div>\r\n                                <i class=\"el-icon-price-tag\"></i>\r\n                                {{ item.rolename }}\r\n                            </div>\r\n                        </div>\r\n                    </el-scrollbar>\r\n                </div>\r\n            </el-card>\r\n        </el-col>\r\n        <el-col :span=\"20\" style=\"padding: 0 20px\">\r\n            <el-card class=\"box-card\">\r\n                <div slot=\"header\" class=\"\">\r\n                    <span>菜单</span>\r\n                    <el-button\r\n                        :loading=\"loadingSave\"\r\n                        @click=\"handleSave\"\r\n                        style=\"float: right; padding: 3px 0\"\r\n                        type=\"text\"\r\n                        >保存</el-button\r\n                    >\r\n                </div>\r\n                <div class=\"block\">\r\n                    <el-row type=\"flex\" justify=\"center\" class=\"tree-parent\">\r\n                        <el-col v-for=\"item in rolerights\" :key=\"item.MENUID\">\r\n                            <el-tree\r\n                                :data=\"item\"\r\n                                ref=\"roleRightTree\"\r\n                                show-checkbox\r\n                                default-expand-all\r\n                                node-key=\"id\"\r\n                                :default-checked-keys=\"checkedMenuids\"\r\n                                :props=\"defaultProps\"\r\n                            >\r\n                            </el-tree>\r\n                        </el-col>\r\n                    </el-row>\r\n                </div>\r\n            </el-card>\r\n        </el-col>\r\n    </el-row>\r\n</template>\r\n\r\n<script>\r\nimport { getRoleRightAll, saveRoleRight, getFrontRoleAll } from \"../../api/api\";\r\n\r\nexport default {\r\n    components: {},\r\n    data() {\r\n        return {\r\n            selectRole: 0,\r\n            loadingSave: false,\r\n            roles: [],\r\n            rolerights: [],\r\n            checkedMenuids: [],\r\n            defaultProps: {\r\n                children: \"children\",\r\n                label: \"label\",\r\n            },\r\n        };\r\n    },\r\n    mounted() {\r\n        this.getRoles();\r\n    },\r\n    methods: {\r\n        getRoles() {\r\n            getFrontRoleAll().then((res) => {\r\n                if (res.success) {\r\n                    let data = res.data.filter((item) => {\r\n                        return item.ROLEID > 1;\r\n                    });\r\n                    this.roles = data;\r\n\r\n                    if (data.length > 0) {\r\n                        if (this.selectRole == 0) {\r\n                            this.selectRole = data[0][\"ROLEID\"];\r\n                        }\r\n\r\n                        this.getRoleRights();\r\n                    }\r\n                }\r\n            });\r\n        },\r\n        getRoleRights() {\r\n            let param = { ROLEID: this.selectRole };\r\n            getRoleRightAll(param).then((res) => {\r\n                if (res.success) {\r\n                    // let data = res.data.filter((item) => {\r\n                    //     return item.ROLEID > 1;\r\n                    // });\r\n                    let rolerightall = [];\r\n                    let item1 = {};\r\n                    let item2 = {};\r\n                    this.checkedMenuids = [];\r\n                    res.data.forEach((item) => {\r\n                        if (item.MENUID.slice(-3) == \"000\") {\r\n                            //第一级\r\n                            if (Object.keys(item2).length > 0) {\r\n                                item1.children.push(item2);\r\n                            }\r\n                            item2 = {};\r\n\r\n                            if (Object.keys(item1).length > 0) {\r\n                                rolerightall.push([item1]);\r\n                            }\r\n                            item1 = {\r\n                                id: item.MENUID,\r\n                                label: item.name,\r\n                                children: [],\r\n                            };\r\n                        } else if (item.sort.slice(-2) == \"00\") {\r\n                            //第二级\r\n                            if (Object.keys(item2).length > 0) {\r\n                                item1.children.push(item2);\r\n                            }\r\n                            item2 = {\r\n                                id: item.MENUID,\r\n                                label: item.name,\r\n                                children: [],\r\n                            };\r\n                            if (item.brole == \"1\") {\r\n                                this.checkedMenuids.push(item.MENUID);\r\n                            }\r\n                        } else {\r\n                            //第三级\r\n                            item2.children.push({\r\n                                id: item.MENUID,\r\n                                label: item.name,\r\n                            });\r\n                            if (item.brole == \"1\") {\r\n                                this.checkedMenuids.push(item.MENUID);\r\n                            }\r\n                        }\r\n                    });\r\n                    //收尾\r\n                    if (Object.keys(item2).length > 0) {\r\n                        item1.children.push(item2);\r\n                    }\r\n                    if (Object.keys(item1).length > 0) {\r\n                        rolerightall.push([item1]);\r\n                    }\r\n                    this.rolerights = rolerightall;\r\n                }\r\n            });\r\n        },\r\n        handleSave() {\r\n            this.loadingSave = true;\r\n            let MENUIDS = [];\r\n            this.$refs.roleRightTree.forEach((t) => {\r\n                let tempids = t.getCheckedKeys(true);\r\n                MENUIDS = MENUIDS.concat(tempids);\r\n            });\r\n            let para = {\r\n                ROLEID: this.selectRole,\r\n                MENUIDS: MENUIDS.join(\",\"),\r\n            };\r\n            saveRoleRight(para).then((res) => {\r\n                if (res.success) {\r\n                    this.$message({\r\n                        message: \"保存成功\",\r\n                        type: \"success\",\r\n                    });\r\n                    this.getRoles();\r\n                } else {\r\n                    this.$message({\r\n                        message: res.msg,\r\n                        type: \"error\",\r\n                    });\r\n                }\r\n\r\n                this.loadingSave = false;\r\n            });\r\n        },\r\n        changeRole(val) {\r\n            this.selectRole = val;\r\n            this.getRoleRights();\r\n        },\r\n    },\r\n};\r\n</script>\r\n<style  scoped>\r\n.box-card /deep/ .el-scrollbar__wrap {\r\n    overflow-x: hidden;\r\n}\r\n.tree-parent /deep/ .el-col:not(:last-child) {\r\n    border-right: 1px solid #f1f1f1;\r\n}\r\n.tree-parent /deep/ .el-tree-node .el-tree-node .el-tree-node {\r\n    float: left;\r\n}\r\n</style>\n\n\n// WEBPACK FOOTER //\n// src/views/roleright/index.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-row',[_c('el-col',{attrs:{\"span\":4}},[_c('el-card',{staticClass:\"box-card left-aside\"},[_c('div',{attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('span',[_vm._v(\"角色\")])]),_vm._v(\" \"),_c('div',{staticStyle:{\"height\":\"70vh\"}},[_c('el-scrollbar',{staticStyle:{\"height\":\"100%\"}},_vm._l((_vm.roles),function(item,index){return _c('div',{key:item.ROLEID,ref:(\"role\" + (item.ROLEID)),refInFor:true,staticClass:\"left-item\",class:item.ROLEID == _vm.selectRole ? 'active' : '',on:{\"click\":function($event){return _vm.changeRole(item.ROLEID)}}},[_c('div',[_c('i',{staticClass:\"el-icon-price-tag\"}),_vm._v(\"\\n                            \"+_vm._s(item.rolename)+\"\\n                        \")])])}),0)],1)])],1),_vm._v(\" \"),_c('el-col',{staticStyle:{\"padding\":\"0 20px\"},attrs:{\"span\":20}},[_c('el-card',{staticClass:\"box-card\"},[_c('div',{attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('span',[_vm._v(\"菜单\")]),_vm._v(\" \"),_c('el-button',{staticStyle:{\"float\":\"right\",\"padding\":\"3px 0\"},attrs:{\"loading\":_vm.loadingSave,\"type\":\"text\"},on:{\"click\":_vm.handleSave}},[_vm._v(\"保存\")])],1),_vm._v(\" \"),_c('div',{staticClass:\"block\"},[_c('el-row',{staticClass:\"tree-parent\",attrs:{\"type\":\"flex\",\"justify\":\"center\"}},_vm._l((_vm.rolerights),function(item){return _c('el-col',{key:item.MENUID},[_c('el-tree',{ref:\"roleRightTree\",refInFor:true,attrs:{\"data\":item,\"show-checkbox\":\"\",\"default-expand-all\":\"\",\"node-key\":\"id\",\"default-checked-keys\":_vm.checkedMenuids,\"props\":_vm.defaultProps}})],1)}),1)],1)])],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-37b2b0ba\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/roleright/index.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-37b2b0ba\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./index.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./index.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./index.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-37b2b0ba\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./index.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-37b2b0ba\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/roleright/index.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}